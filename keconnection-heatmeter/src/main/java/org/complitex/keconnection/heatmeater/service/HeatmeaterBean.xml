<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.complitex.keconnection.heatmeater.service.HeatmeaterBean">
    <resultMap id="heatmeaterResultMap" type="org.complitex.keconnection.heatmeater.entity.Heatmeater">
        <id property="id"/>
        <result property="gek"/>
        <result property="dom"/>
        <result property="ul"/>
        <result property="ndom"/>
        <result property="lotop0"/>
        <result property="lotop1"/>
        <result property="lotop2"/>
        <result property="lotop3"/>
        <result property="lotop4"/>
        <result property="organizationId"/>
        <result property="buildingId"/>
    </resultMap>

    <insert id="insertHeatmeater" parameterType="org.complitex.keconnection.heatmeater.entity.Heatmeater">
        insert into `heatmeater` (`gek`, `dom`, `ul`, `ndom`, `lotop0`, `lotop1`, `lotop2`, `lotop3`, `lotop4`,
          `organization_id`, `building_id`)
        values (#{gek}, #{dom}, #{ul}, #{ndom}, #{lotop0}, #{lotop1}, #{lotop2}, #{lotop3}, #{lotop4},
          #{organizationId}, #{buildingId})
    </insert>

    <update id="updateHeatmeater" parameterType="org.complitex.keconnection.heatmeater.entity.Heatmeater">
        update `heatmeater` set `gek` = #{gek}, `dom` = #{dom}, `ul` = #{ul}, `ndom` = #{ndom}, `lotop0` = #{lotop0},
          `lotop1` = #{lotop1}, `lotop2` = #{lotop2}, `lotop3` = #{lotop3}, `lotop4` = #{lotop4},
          `organization_id` = #{organizationId}, `building_id` = #{buildingId}
    </update>

    <select id="selectHeatmeater" parameterType="long" resultMap="heatmeaterResultMap">
        select * from `heatmeater` where `id` = #{id}
    </select>

    <sql id="selectHeatmeatersWhere">
        <where>
            <if test="object.gek != null">`gek` = #{object.gek}</if>
            <if test="object.dom != null">and `dom` = #{object.dom}</if>
            <if test="object.ul != null">and `ul` like concat('%', #{object.ul}, '%')</if>
            <if test="object.ndom != null">and `ndom` like concat('%', #{object.ndom}, '%')</if>
            <if test="object.lotop0 != null">and `lotop0` = #{object.lotop0}</if>
            <if test="object.lotop1 != null">and `lotop1` = #{object.lotop1}</if>
            <if test="object.lotop2 != null">and `lotop2` = #{object.lotop2}</if>
            <if test="object.lotop3 != null">and `lotop3` = #{object.lotop3}</if>
            <if test="object.lotop4 != null">and `lotop4` = #{object.lotop4}</if>
            <if test="object.organizationId != null">and `organization_id` = #{object.organizationId}</if>
            <if test="object.buildingId != null">and `building_id` = #{object.buildingId}</if>
        </where>
    </sql>

    <select id="selectHeatmeaters" parameterType="org.complitex.dictionary.entity.FilterWrapper"
            resultMap="heatmeaterResultMap">
        select * from `heatmeater` <include refid="selectHeatmeatersWhere"/>
        order by ${sortProperty} ${asc} limit #{first}, #{count}
    </select>

    <select id="selectHeatmeatersCount" parameterType="org.complitex.dictionary.entity.FilterWrapper"
            resultType="int">
        select count(*) from `heatmeater` <include refid="selectHeatmeatersWhere"/>
    </select>

    <delete id="deleteHeatmeater" parameterType="long">
        delete from `heatmeater` where `id` = #{id}
    </delete>

    <select id="isExistHeatmeater" parameterType="org.complitex.keconnection.heatmeater.entity.Heatmeater"
            resultType="boolean">
        select count(*) > 0 from `heatmeater` where `gek` = #{gek} and `dom` = #{dom} and `ul` = #{ul}
                and `ndom` = #{ndom}
    </select>
</mapper>